## 1. 马尔可夫网络、马尔可夫模型、马尔可夫过程、贝叶斯网络的区别

- **网络：**将随机变量作为节点，若两个随机变量相关或不独立，则两者连接一条边；若给定若干随机变量，则形成了一个也有向图
- **贝叶斯网络：**有向无环图
- **马尔可夫模型：**这个图退缩成线性链的统计模型
- **马尔可夫过程：**因为每个节点都是随机变量，将其看成各个时刻的相关变化，以随机过程的视角（n阶，包括了状态、初始向量、状态转移矩阵）
- **隐马尔可夫模型：**状态：（隐含状态、可见状态）；**它是结构最简单的动态贝叶斯网，这是一种著名的有向图模型**，主要用于时序数据建模，在语音识别、自然语言处理等领域有广泛应用。
- **马尔可夫随机场或马尔可夫网络：**，无向图模型
- **条件随机场：**给定某些条件下，研究马尔可夫随机场
- **线性链条件随机场：**如果条件随机场解决标注问题，并且进一步将进一步的条件随机场中的网络拓扑变成线性的
- **极大似然估计：**知道结果，反推条件θ。极大似然就相当于最大可能的意思。

## 2. EM算法、HMM、CRF比较

- **EM算法：最大期望算法（Expectation-maximization algorithm，**用于含有隐变量模型的极大似然估计或者极大后验估计，由两部组成：**E步求期望；M步求极大**。本质上EM算法是一个迭代算法，通过不断用上一代参数对隐变量的估计对当前变量进行计算，直至收敛。
  - EM算法对初始值敏感，而EM是不断求解下界的极大化逼近求解对数似然的极大化的算法，也就是说EM算法不能保证全局最优解
- **HMM：**用于序列标注问题的**生成模型**。由几个参数$（\pi,A,B）$，其中$\pi$是初始状态概率向量，$A$为状态转移矩阵，$B$为观测概率矩阵。
  - 马尔可夫模型的三要素，三个基本问题：
    - **概率计算问题：**给定模型和观测序列，计算模型下**观测序列输出的概率** --> 前向后向算法
    - **学习问题：**给定观测序列，去估计模型的参数，即用极大似然估计来估计参数 （如果用模型去最好地描述数据）--> Baum-Welch(约等于EM算法)和极大似然估计
    - **预测问题：**已知模型和观测序列，求解**对应的状态序列（隐含状态）** --> 近似算法(贪心算法)和维特比算法(动态规划和最优路径)
- **CRF：**给定一组输入随机变量的条件下另外一组输出随机变量的条件概率分布密度。**判别模型+时序**
  - CRF假设输出变量构成马尔可夫随机场，而我们平时看到的大多数是线性链条件随机场，也就是输入对输出进行预测的判别模型，求解方法为极大似然估计或者正则化的极大似然估计
  - CRF也有：概率计算问题、学习问题和预测问题。大致计算方法和HMM类似，只不过不需要EM算法进行学习问题。

## 3. 极大似然的求解

**求极大似然函数估计值的一般步骤：**

- 写出似然函数；
- 对似然函数取对数，并整理；
- 求导数，令导数为0，得到似然方程；
- 解似然方程，得到的参数即为所求；

## 4. EM算法

1. 随机初始化分布参数θ

2. E步，求Q函数，对于每一个i，计算根据上一次迭代的模型参数来计算出隐性变量的后验概率（其实就是隐性变量的期望），来作为隐藏变量的现估计值：

   ![](http://wx1.sinaimg.cn/mw690/00630Defly1g57brmij1wj307l01cq2s.jpg)

3. M步，求使Q函数获得极大时的参数取值）将似然函数最大化以获得新的参数值

   ![](http://wx1.sinaimg.cn/mw690/00630Defly1g57bswusk1j30de01s3yh.jpg)

4. 然后循环重复2、3步直到收敛。

用EM算法求解的模型一般有GMM或者协同过滤，k-means其实也属于EM。EM算法一定会收敛，但是可能收敛到局部最优。由于求和的项数将随着隐变量的数目指数上升，会给梯度计算带来麻烦。



## 参考文献

1. [条件随机场的简单理解](https://blog.csdn.net/weixin_41911765/article/details/82465697)
2. [如何轻松愉快地理解条件随机场（CRF）](https://blog.csdn.net/dcx_abc/article/details/78319246)
3. [《数学之美》](https://www.lanzous.com/i3ousch)
4. [监督学习方法与Baum-Welch算法](https://blog.csdn.net/qq_37334135/article/details/86302735)
5. [从贝叶斯方法谈到贝叶斯网络](https://blog.csdn.net/v_july_v/article/details/40984699)